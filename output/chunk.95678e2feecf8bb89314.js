(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{2764:function(e,r,n){"use strict";n.r(r);var t=n(3),i=n.n(t),s=n(1),o=n.n(s),a=n(29),c=n(142),l=n.n(c),u=n(7),d=n(9),p=n(2948),b=n(237),j=n(2),f=n(20),g=n(2992),m=n(415),h=n(2981),v=n(0);function y(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function O(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?y(Object(n),!0).forEach((function(r){x(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function x(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function w(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var t,i,s=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(t=n.next()).done)&&(s.push(t.value),!r||s.length!==r);o=!0);}catch(e){a=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw i}}return s}(e,r)||function(e,r){if(!e)return;if("string"==typeof e)return D(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}var S={data:o.a.shape({line:o.a.shape({coverage:o.a.arrayOf(o.a.object),customCoverage:o.a.bool,endDate:o.a.string,id:o.a.string,note:o.a.string,owner:o.a.shape({name:o.a.string.isRequired}),poLines:o.a.arrayOf(o.a.shape({id:o.a.string,titleOrPackage:o.a.string,poLineNumber:o.a.string})),resource:o.a.shape({_object:o.a.object}),startDate:o.a.string,tags:o.a.shape({length:o.a.number})}).isRequired,settings:o.a.object}),handlers:o.a.shape({isSuppressFromDiscoveryEnabled:o.a.func.isRequired,onClose:o.a.func.isRequired,onDelete:o.a.func.isRequired,onEdit:o.a.func.isRequired,onToggleTags:o.a.func}).isRequired,helperApp:o.a.node,isLoading:o.a.bool},T=function(e){var r,n,i,s,o,c,l,p,y,x=e.data.line,D=e.handlers,S=e.helperApp,T=e.isLoading,L=Object(u.s)(),q={defaultWidth:"55%",dismissible:!0,id:"pane-view-agreement-line",onClose:D.onClose},R=Object(t.useRef)(),k=Object(b.a)(),E=w(Object(t.useState)(!1),2),P=E[0],F=E[1];if(T)return Object(v.jsx)(j.Q,O({"data-loading":!0},q));var I=Object(m.f)(x)?x:null!==(r=null===(n=x.resource)||void 0===n?void 0:n._object)&&void 0!==r?r:{},C=null!==(i=null!==(s=null===(o=I.pti)||void 0===o?void 0:o.titleInstance.name)&&void 0!==s?s:null===(c=I.reference_object)||void 0===c?void 0:c.label)&&void 0!==i?i:"",A=[{name:"edit",handler:D.onEdit},{name:"expandAllSections",handler:function(e){return Object(j.Jb)(e,R)}},{name:"collapseAllSections",handler:function(e){return Object(j.Eb)(e,R)}}];return Object(v.jsx)(j.C,{commands:A,isWithinScope:j.Db,scope:document.body,children:Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(j.db,O(O({actionMenu:function(){return L.hasPerm("ui-agreements.agreements.edit")?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(j.f,{buttonStyle:"dropdownItem",id:"clickable-dropdown-edit-agreement-line",onClick:D.onEdit,children:Object(v.jsx)(j.G,{icon:"edit",children:Object(v.jsx)(a.a,{id:"ui-agreements.agreements.edit"})})}),Object(v.jsx)(j.f,{buttonStyle:"dropdownItem",id:"clickable-dropdown-delete-agreement-line",onClick:function(){return F(!0)},children:Object(v.jsx)(j.G,{icon:"trash",children:Object(v.jsx)(a.a,{id:"ui-agreements.delete"})})})]}):null},appIcon:Object(v.jsx)(u.b,{app:"agreements"}),lastMenu:Object(v.jsx)(u.f,{perm:"ui-agreements.agreements.edit",children:Object(v.jsx)(j.jb,{children:D.onToggleTags&&Object(v.jsx)(j.H,{ariaLabel:k.formatMessage({id:"ui-agreements.agreements.showTags"}),badgeCount:null!==(l=null==x||null===(p=x.tags)||void 0===p?void 0:p.length)&&void 0!==l?l:0,icon:"tag",id:"clickable-show-tags",onClick:D.onToggleTags})})}),paneTitle:Object(v.jsx)(a.a,{id:"ui-agreements.agreementLine"})},q),{},{children:[Object(v.jsx)(g.f,{isSuppressFromDiscoveryEnabled:D.isSuppressFromDiscoveryEnabled,line:x,resource:I}),Object(v.jsxs)(j.c,{ref:R,children:[Object(v.jsx)(j.sb,{end:"xs",children:Object(v.jsx)(j.k,{xs:!0,children:Object(v.jsx)(j.v,{id:"clickable-expand-all"})})}),Object(v.jsxs)(j.b,{children:[Object(v.jsx)(g.g,{line:x,resource:I}),Object(v.jsx)(g.a,{line:x,resource:I}),Object(v.jsx)(a.a,{id:"ui-agreements.line.lineForAgreement",values:{agreementName:null===(y=x.owner)||void 0===y?void 0:y.name},children:function(e){var r;return Object(v.jsx)(d.x,{domainName:"agreements",entityId:null!==(r=x.id)&&void 0!==r?r:"-",entityName:null!=e?e:"-",entityType:"agreementLine",id:"agreement-line-notes",pathToNoteCreate:m.h.noteCreate(),pathToNoteDetails:m.h.notes()})}}),(D.isSuppressFromDiscoveryEnabled("pci")||D.isSuppressFromDiscoveryEnabled("title")||D.isSuppressFromDiscoveryEnabled("agreementLine"))&&Object(v.jsx)(h.a,{handlers:D,id:"discoverySettings",line:x})]})]})]})),S,Object(v.jsx)(j.m,{buttonStyle:"danger",confirmLabel:Object(v.jsx)(a.a,{id:"ui-agreements.delete"}),heading:Object(v.jsx)(a.a,{id:"ui-agreements.agreementLines.deleteAgreementLine"}),id:"delete-agreement-line-confirmation",message:Object(v.jsx)(f.a,{id:"ui-agreements.agreementLines.deleteConfirmMessage",values:{name:C}}),onCancel:function(){return F(!1)},onConfirm:function(){D.onDelete(),F(!1)},open:P})]})})};T.propTypes=S;var L=T;function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function k(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?R(Object(n),!0).forEach((function(r){E(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function E(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function P(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function F(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function I(e,r){return(I=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(e,r)}function C(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,t=_(e);if(r){var i=_(this).constructor;n=Reflect.construct(t,arguments,i)}else n=t.apply(this,arguments);return A(this,n)}}function A(e,r){if(r&&("object"===q(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var J=function(e){!function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&I(e,r)}(s,e);var r,n,t,i=C(s);function s(){var e;P(this,s);for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return(e=i.call.apply(i,[this].concat(n))).getHelperApp=function(){var r,n=e.props,t=n.match,i=null===(r=n.resources.query)||void 0===r?void 0:r.helper;if(!i)return null;var s=null;return"tags"===i&&(s=p.a),s?Object(v.jsx)(s,{link:"erm/entitlements/".concat(t.params.lineId),onToggle:function(){return e.handleToggleHelper(i)}}):null},e.getCompositeLine=function(){var r,n,t,i,s=e.props.resources,o=null!==(r=null===(n=s.line)||void 0===n||null===(t=n.records)||void 0===t?void 0:t[0])&&void 0!==r?r:{},a=(null===(i=s.orderLines)||void 0===i?void 0:i.records)||[],c=(o.poLines||[]).map((function(e){return a.find((function(r){return r.id===e.poLineId}))})).filter((function(e){return e}));return k(k({},o),{},{poLines:c})},e.handleClose=function(){var r=e.props,n=r.history,t=r.location,i=r.match;n.push("".concat(m.h.agreementView(i.params.agreementId)).concat(t.search))},e.handleDelete=function(){var r=e.props,n=r.history,t=r.location,i=r.match.params,s=i.agreementId,o=i.lineId,c=r.mutator,l=e.context.sendCallout;c.agreement.PUT({id:s,items:[{id:o,_delete:!0}]}).then((function(){n.push("".concat(m.h.agreementView(s)).concat(t.search)),l({message:Object(v.jsx)(a.a,{id:"ui-agreements.line.delete.callout"})})})).catch((function(e){l({type:"error",timeout:0,message:Object(v.jsx)(a.a,{id:"ui-agreements.line.deleteFailed.callout",values:{message:e.message}})})}))},e.handleEdit=function(){var r=e.props,n=r.history,t=r.location,i=r.match.params,s=i.agreementId,o=i.lineId;n.push("".concat(m.h.agreementLineEdit(s,o)).concat(t.search))},e.handleToggleHelper=function(r){var n=e.props,t=n.mutator,i=n.resources.query.helper!==r?r:null;t.query.update({helper:i})},e.handleToggleTags=function(){e.handleToggleHelper("tags")},e.isLoading=function(){var r,n,t,i,s,o=e.props,a=o.match,c=o.resources;return a.params.lineId!==(null===(r=c.line)||void 0===r||null===(n=r.records)||void 0===n||null===(t=n[0])||void 0===t?void 0:t.id)&&(null===(i=null==c||null===(s=c.line)||void 0===s?void 0:s.isPending)||void 0===i||i)},e}return r=s,(n=[{key:"render",value:function(){var e,r,n=this.props,t=n.resources,i=n.tagsEnabled,s=n.isSuppressFromDiscoveryEnabled;return Object(v.jsx)(L,{data:{line:this.getCompositeLine()},handlers:k(k({},this.props.handlers),{},{isSuppressFromDiscoveryEnabled:s,onClose:this.handleClose,onDelete:this.handleDelete,onEdit:this.handleEdit,onToggleTags:i?this.handleToggleTags:void 0}),helperApp:this.getHelperApp(),isLoading:this.isLoading()},null!==(e=null===(r=t.line)||void 0===r?void 0:r.loadedAt)&&void 0!==e?e:"loading")}}])&&F(r.prototype,n),t&&F(r,t),s}(i.a.Component);J.manifest=Object.freeze({agreement:{type:"okapi",path:"erm/sas/:{agreementId}",fetch:!1},line:{type:"okapi",path:"erm/entitlements/:{lineId}",throwErrors:!1},orderLines:{type:"okapi",path:"orders/order-lines",params:function(e,r,n,t,i){var s,o,a,c,l=(null!==(s=null===(o=i.resources.line)||void 0===o||null===(a=o.records)||void 0===a||null===(c=a[0])||void 0===c?void 0:c.poLines)&&void 0!==s?s:[]).map((function(e){return"id==".concat(e.poLineId)})).join(" or ");return l?{query:l}:null},fetch:function(e){return!!e.stripes.hasInterface("order-lines","1.0 2.0")},records:"poLines",throwErrors:!1},query:{}}),J.propTypes={handlers:o.a.object,history:o.a.shape({push:o.a.func.isRequired}).isRequired,isSuppressFromDiscoveryEnabled:o.a.func.isRequired,location:o.a.shape({search:o.a.string.isRequired}).isRequired,match:o.a.shape({params:o.a.shape({agreementId:o.a.string.isRequired,lineId:o.a.string.isRequired}).isRequired}).isRequired,mutator:o.a.shape({agreement:o.a.shape({PUT:o.a.func.isRequired}).isRequired,query:o.a.shape({update:o.a.func.isRequired}).isRequired}).isRequired,resources:o.a.shape({line:o.a.object,orderLines:o.a.object,query:o.a.object}).isRequired,stripes:o.a.shape({hasInterface:o.a.func.isRequired,hasPerm:o.a.func.isRequired}).isRequired,tagsEnabled:o.a.bool},J.contextType=u.c;r.default=l()(u.o,m.j,d.U)(J)},2981:function(e,r,n){"use strict";n.d(r,"a",(function(){return l}));n(3);var t=n(1),i=n.n(t),s=n(29),o=n(2),a=n(0),c=function(e){var r,n=e.handlers.isSuppressFromDiscoveryEnabled,t=e.id,i=e.line,c=e.pci,l=e.title,u=n("agreementLine"),d=n("pci"),p=n("title");return i?r=function(){var e,r,n,t,c;return Object(a.jsxs)(o.sb,{children:[u&&Object(a.jsx)(o.k,{xs:3,children:Object(a.jsx)(o.J,{label:Object(a.jsx)(s.a,{id:"ui-agreements.eresources.discoverySettings.suppressFromDiscoveryAgreementLine",values:{breakingLine:Object(a.jsx)("br",{})}}),children:Object(a.jsx)("div",{children:Object(a.jsx)(s.a,{id:"ui-agreements.".concat(null!=i&&i.suppressFromDiscovery?"yes":"no")})})})}),d&&Object(a.jsx)(o.k,{xs:3,children:Object(a.jsx)(o.J,{label:Object(a.jsx)(s.a,{id:"ui-agreements.eresources.discoverySettings.suppressFromDiscoveryTitleInPackage",values:{breakingLine:Object(a.jsx)("br",{})}}),children:Object(a.jsx)("div",{children:Object(a.jsx)(s.a,{id:"ui-agreements.".concat(null!=i&&null!==(e=i.resource)&&void 0!==e&&e.suppressFromDiscovery?"yes":"no")})})})}),p&&Object(a.jsx)(o.k,{xs:3,children:Object(a.jsx)(o.J,{label:Object(a.jsx)(s.a,{id:"ui-agreements.eresources.discoverySettings.suppressFromDiscoveryTitle",values:{breakingLine:Object(a.jsx)("br",{})}}),children:Object(a.jsx)("div",{children:Object(a.jsx)(s.a,{id:"ui-agreements.".concat(null!=i&&null!==(r=i.resource)&&void 0!==r&&null!==(n=r._object)&&void 0!==n&&null!==(t=n.pti)&&void 0!==t&&null!==(c=t.titleInstance)&&void 0!==c&&c.suppressFromDiscovery?"yes":"no")})})})})]})}:c?r=function(){var e,r;return Object(a.jsxs)(o.sb,{children:[d&&Object(a.jsx)(o.k,{xs:3,children:Object(a.jsx)(o.J,{label:Object(a.jsx)(s.a,{id:"ui-agreements.eresources.discoverySettings.suppressFromDiscoveryTitleInPackage",values:{breakingLine:Object(a.jsx)("br",{})}}),children:Object(a.jsx)("div",{children:Object(a.jsx)(s.a,{id:"ui-agreements.".concat(null!=c&&c.suppressFromDiscovery?"yes":"no")})})})}),p&&Object(a.jsx)(o.k,{xs:3,children:Object(a.jsx)(o.J,{label:Object(a.jsx)(s.a,{id:"ui-agreements.eresources.discoverySettings.suppressFromDiscoveryTitle",values:{breakingLine:Object(a.jsx)("br",{})}}),children:Object(a.jsx)("div",{children:Object(a.jsx)(s.a,{id:"ui-agreements.".concat(null!=c&&null!==(e=c.pti)&&void 0!==e&&null!==(r=e.titleInstance)&&void 0!==r&&r.suppressFromDiscovery?"yes":"no")})})})})]})}:l&&(r=function(){var e;return Object(a.jsx)(o.J,{label:Object(a.jsx)(s.a,{id:"ui-agreements.eresources.discoverySettings.suppressFromDiscoveryTitle",values:{breakingLine:Object(a.jsx)("br",{})}}),children:Object(a.jsx)(s.a,{id:"ui-agreements.".concat(null!=l&&null!==(e=l.eresource)&&void 0!==e&&e.suppressFromDiscovery?"yes":"no")})})}),r?Object(a.jsx)(o.a,{id:t,label:Object(a.jsx)(s.a,{id:"ui-agreements.eresources.discoverySettings"}),children:r()}):null};c.propTypes={handlers:i.a.shape({isSuppressFromDiscoveryEnabled:i.a.func.isRequired}),id:i.a.string,line:i.a.object,pci:i.a.object,title:i.a.object};var l=c}}]);