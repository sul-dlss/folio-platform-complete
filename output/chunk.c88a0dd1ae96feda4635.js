(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{2745:function(e,t,r){"use strict";r.r(t);var n=r(3),o=r.n(n),a=r(1),i=r.n(a),s=r(142),u=r.n(s),c=r(20),l=r(2),d=r(7),f=r(2951),p=r(2985),m=r(2986),b=r(2987),h=r(2973),y=r(415),j=r(0);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){P(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e){return function(e){if(Array.isArray(e))return R(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=V(e);if(t){var o=V(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return w(this,r)}}function w(e,t){if(t&&("object"===g(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(a,e);var t,r,n,o=x(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this,e)).handleBasketLinesAdded=function(){t.props.mutator.query.update({addFromBasket:null,authority:null,referenceId:null})},t.handleClose=function(){var e=t.props.location;t.props.history.push("".concat(y.h.agreements()).concat(e.search))},t.handleSubmit=function(e){var r,n,o=t.props,a=o.history,i=o.location,s=o.mutator,l=o.resources,d=null!==(r=null==l||null===(n=l.relationshipTypeValues)||void 0===n?void 0:n.records)&&void 0!==r?r:[],f=null==e?void 0:e.name;return u()(m.b)(e,d),s.agreements.POST(e).then((function(e){var r=e.id;t.context.sendCallout({message:Object(j.jsx)(c.a,{id:"ui-agreements.agreements.create.callout",values:{name:f}})}),a.push("".concat(y.h.agreementView(r)).concat(i.search))}))},t.getAgreementLinesToAdd=function(){var e,r,n=t.props.resources,o=n.query,a=void 0===o?{}:o,i=null!==(e=null==n||null===(r=n.externalAgreementLine)||void 0===r?void 0:r.records)&&void 0!==e?e:[],s=[];if(a.addFromBasket){var u,c=null!==(u=null==n?void 0:n.basket)&&void 0!==u?u:[];s=a.addFromBasket.split(",").map((function(e){return{resource:c[parseInt(e,10)]}})).filter((function(e){return e.resource}))}return[].concat(S(i),S(s))},t.fetchIsPending=function(){return Object.values(t.props.resources).filter((function(e){return e&&"agreements"!==e.resource})).some((function(e){return e.isPending}))},t.getInitialValues=function(){var e,r,n={};((null===(e=t.props.resources)||void 0===e||null===(r=e.supplementaryProperties)||void 0===r?void 0:r.records)||[]).filter((function(e){return e.primary})).forEach((function(e){n[e.name]=""}));return{periods:[{}],customProperties:n}},t.state={hasPerms:e.stripes.hasPerm("ui-agreements.agreements.edit")},t}return t=a,(r=[{key:"render",value:function(){var e,t,r,n,o,a,i,s,u,c,d,f,p,m,y,g,v,P,S,R,k,A=this.props,x=A.handlers,w=A.resources;return this.state.hasPerms?this.fetchIsPending()?Object(j.jsx)(l.R,{dismissible:!0,onClose:this.handleClose}):Object(j.jsx)(b.a,{data:{agreementLines:this.getAgreementLinesToAdd(),agreementLinesToAdd:this.getAgreementLinesToAdd(),agreementStatusValues:null!==(e=null==w||null===(t=w.agreementStatusValues)||void 0===t?void 0:t.records)&&void 0!==e?e:[],reasonForClosureValues:null!==(r=null==w||null===(n=w.reasonForClosureValues)||void 0===n?void 0:n.records)&&void 0!==r?r:[],amendmentStatusValues:null!==(o=null==w||null===(a=w.amendmentStatusValues)||void 0===a?void 0:a.records)&&void 0!==o?o:[],basket:null!==(i=null==w?void 0:w.basket)&&void 0!==i?i:[],supplementaryProperties:null!==(s=null==w||null===(u=w.supplementaryProperties)||void 0===u?void 0:u.records)&&void 0!==s?s:[],contactRoleValues:null!==(c=null==w||null===(d=w.contactRoleValues)||void 0===d?void 0:d.records)&&void 0!==c?c:[],documentCategories:null!==(f=null==w||null===(p=w.documentCategories)||void 0===p?void 0:p.records)&&void 0!==f?f:[],isPerpetualValues:null!==(m=null==w||null===(y=w.isPerpetualValues)||void 0===y?void 0:y.records)&&void 0!==m?m:[],licenseLinkStatusValues:null!==(g=null==w||null===(v=w.licenseLinkStatusValues)||void 0===v?void 0:v.records)&&void 0!==g?g:[],orgRoleValues:null!==(P=null==w||null===(S=w.orgRoleValues)||void 0===S?void 0:S.records)&&void 0!==P?P:[],renewalPriorityValues:null!==(R=null==w||null===(k=w.renewalPriorityValues)||void 0===k?void 0:k.records)&&void 0!==R?R:[],users:[]},handlers:O(O({},x),{},{onBasketLinesAdded:this.handleBasketLinesAdded,onAsyncValidate:this.props.checkAsyncValidation,onClose:this.handleClose}),initialValues:this.getInitialValues(),isLoading:this.fetchIsPending(),onSubmit:this.handleSubmit}):Object(j.jsx)(h.a,{})}}])&&k(t.prototype,r),n&&k(t,n),a}(o.a.Component);q.manifest=Object.freeze({agreements:{type:"okapi",path:"erm/sas",fetch:!1,shouldRefresh:function(){return!1}},supplementaryProperties:{type:"okapi",path:"erm/custprops",shouldRefresh:function(){return!1}},agreementStatusValues:{type:"okapi",path:"erm/refdata/SubscriptionAgreement/agreementStatus",shouldRefresh:function(){return!1}},reasonForClosureValues:{type:"okapi",path:"erm/refdata/SubscriptionAgreement/reasonForClosure",limitParam:"perPage",perRequest:100,shouldRefresh:function(){return!1}},amendmentStatusValues:{type:"okapi",path:"erm/refdata/LicenseAmendmentStatus/status",shouldRefresh:function(){return!1}},contactRoleValues:{type:"okapi",path:"erm/refdata/InternalContact/role",limitParam:"perPage",perRequest:100,shouldRefresh:function(){return!1}},documentCategories:{type:"okapi",path:"erm/refdata/DocumentAttachment/atType",limitParam:"perPage",perRequest:100,shouldRefresh:function(){return!1}},externalAgreementLine:{type:"okapi",path:"erm/entitlements/external",shouldRefresh:function(){return!1},params:{authority:"?{authority}",reference:"?{referenceId}"},throwErrors:!1},isPerpetualValues:{type:"okapi",path:"erm/refdata/SubscriptionAgreement/isPerpetual",shouldRefresh:function(){return!1}},licenseLinkStatusValues:{type:"okapi",path:"erm/refdata/RemoteLicenseLink/status",shouldRefresh:function(){return!1}},orgRoleValues:{type:"okapi",path:"erm/refdata/SubscriptionAgreementOrg/role",shouldRefresh:function(){return!1}},relationshipTypeValues:{type:"okapi",path:"erm/refdata/AgreementRelationship/type",shouldRefresh:function(){return!1}},renewalPriorityValues:{type:"okapi",path:"erm/refdata/SubscriptionAgreement/renewalPriority",limitParam:"perPage",perRequest:100,shouldRefresh:function(){return!1}},basket:{initialValue:[]},query:{initialValue:{}}}),q.propTypes={checkAsyncValidation:i.a.func,handlers:i.a.object,history:i.a.shape({push:i.a.func.isRequired}).isRequired,location:i.a.shape({search:i.a.string.isRequired}).isRequired,mutator:i.a.shape({agreements:i.a.shape({POST:i.a.func.isRequired}).isRequired,query:i.a.shape({update:i.a.func.isRequired}).isRequired}),resources:i.a.shape({agreement:i.a.object,agreementStatusValues:i.a.shape({records:i.a.arrayOf(i.a.object)}),amendmentStatusValues:i.a.shape({records:i.a.arrayOf(i.a.object)}),basket:i.a.arrayOf(i.a.object),contactRoleValues:i.a.shape({records:i.a.arrayOf(i.a.object)}),documentCategories:i.a.shape({records:i.a.arrayOf(i.a.object)}),externalAgreementLine:i.a.shape({records:i.a.arrayOf(i.a.object)}),isPerpetualValues:i.a.shape({records:i.a.arrayOf(i.a.object)}),licenseLinkStatusValues:i.a.shape({records:i.a.arrayOf(i.a.object)}),orgRoleValues:i.a.object,query:i.a.shape({addFromBasket:i.a.string}),reasonForClosureValues:i.a.shape({records:i.a.arrayOf(i.a.object)}),relationshipTypeValues:i.a.shape({records:i.a.arrayOf(i.a.object)}),renewalPriorityValues:i.a.shape({records:i.a.arrayOf(i.a.object)}),statusValues:i.a.object,supplementaryProperties:i.a.object,typeValues:i.a.object}).isRequired,stripes:i.a.shape({hasPerm:i.a.func.isRequired,okapi:i.a.object.isRequired}).isRequired},q.defaultProps={handlers:{}},q.contextType=d.c,t.default=u()(p.a,f.a,d.o)(q)},2973:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r(3);var n=r(29),o=r(2),a=r(0),i=function(){return Object(a.jsxs)(o.M,{className:"textCentered",children:[Object(a.jsx)("h2",{children:Object(a.jsx)(n.a,{id:"stripes-smart-components.permissionError"})}),Object(a.jsx)("p",{children:Object(a.jsx)(n.a,{id:"stripes-smart-components.permissionsDoNotAllowAccess"})})]})}},2987:function(e,t,r){"use strict";var n=r(3),o=r.n(n),a=r(1),i=r.n(a),s=r(4),u=r(29),c=r(120),l=r(1391),d=r(7),f=r(2),p=r(22),m=r(2991),b=r(0);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=A(e);if(t){var o=A(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return k(this,r)}}function k(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(i,e);var t,r,n,a=R(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this,e)).state={addedLinesToAdd:!1},t.getInitialAccordionsState=function(){return{formInternalContacts:!0,formLines:!0,formLicenses:!0,formOrganizations:!0,formSupplementaryProperties:!0,formSupplementaryDocs:!0,formUsageProviders:!0,formRelatedAgreements:!0}},t.shortcuts=[{name:"save",handler:function(e){return Object(l.a)(e,t.props)}},{name:"expandAllSections",handler:function(e){return Object(f.Jb)(e,t.accordionStatusRef)}},{name:"collapseAllSections",handler:function(e){return Object(f.Eb)(e,t.accordionStatusRef)}}],t.accordionStatusRef=o.a.createRef(),t}return t=i,n=[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.form.getState();return e.data.agreementLinesToAdd.length&&!1===t.addedLinesToAdd&&e.form.getRegisteredFields().includes("items")?(e.form.change("items",[].concat(y(Object(s.get)(r,"initialValues.items",[])),y(e.data.agreementLinesToAdd))),e.handlers.onBasketLinesAdded(),{addedLinesToAdd:!0}):null}}],(r=[{key:"getSectionProps",value:function(e){var t=this.props,r=t.data,n=t.form,o=t.handlers,a=t.initialValues,i=t.values;return{data:r,form:n,handlers:o,id:e,initialValues:a,values:void 0===i?{}:i}}},{key:"renderPaneFooter",value:function(){var e=this.props,t=e.handlers,r=e.handleSubmit,n=e.pristine,o=e.submitting,a=e.values;return Object(b.jsx)(f.gb,{renderEnd:Object(b.jsx)(f.f,{buttonStyle:"primary mega",disabled:n||o,id:a.id?"clickable-update-agreement":"clickable-create-agreement",marginBottom0:!0,onClick:r,type:"submit",children:Object(b.jsx)(u.a,{id:"stripes-components.saveAndClose"})}),renderStart:Object(b.jsx)(f.f,{buttonStyle:"default mega",id:"clickable-cancel",marginBottom0:!0,onClick:t.onClose,children:Object(b.jsx)(u.a,{id:"stripes-components.cancel"})})})}},{key:"renderFirstMenu",value:function(){var e=this;return Object(b.jsx)(f.jb,{children:Object(b.jsx)(u.a,{id:"ui-agreements.agreements.closeEdit",children:function(t){return Object(b.jsx)(f.H,{"aria-label":t,icon:"times",id:"close-agreement-form-button",onClick:e.props.handlers.onClose})}})})}},{key:"render",value:function(){var e=this,t=this.props,r=t.data,n=t.form,o=t.values,a=o.id,i=o.name,s=n.getRegisteredFields().length>0;return Object(b.jsx)(f.C,{commands:this.shortcuts,isWithinScope:f.Db,scope:document.body,children:Object(b.jsx)(f.kb,{children:Object(b.jsx)(u.a,{id:"ui-agreements.create",children:function(t){var n;return Object(b.jsx)(f.db,{appIcon:Object(b.jsx)(d.b,{app:"agreements"}),centerContent:!0,defaultWidth:"100%",firstMenu:e.renderFirstMenu(),footer:e.renderPaneFooter(),id:"pane-agreement-form",paneTitle:a?i:Object(b.jsx)(u.a,{id:"ui-agreements.agreements.createAgreement"}),children:Object(b.jsx)(d.k,{record:a?i:t,children:Object(b.jsx)("form",{id:"form-agreement",children:Object(b.jsxs)(f.c,{ref:e.accordionStatusRef,children:[s?Object(b.jsx)("div",{id:"form-loaded"}):null,Object(b.jsx)(f.sb,{end:"xs",children:Object(b.jsx)(f.k,{xs:!0,children:Object(b.jsx)(f.v,{})})}),Object(b.jsxs)(f.b,{initialStatus:e.getInitialAccordionsState(),children:[Object(b.jsx)(m.d,v({},e.getSectionProps("formInfo"))),Object(b.jsx)(d.f,{perm:"users.collection.get",children:function(t){return t.hasPermission?Object(b.jsx)(m.e,v({},e.getSectionProps("formInternalContacts"))):null}}),Object(b.jsx)(m.g,v({},e.getSectionProps("formLines"))),Object(b.jsx)(m.f,v({},e.getSectionProps("formLicenses"))),Object(b.jsx)(m.h,v({},e.getSectionProps("formOrganizations"))),(null===(n=r.supplementaryProperties)||void 0===n?void 0:n.length)>0?Object(b.jsx)(m.k,v({},e.getSectionProps("formSupplementaryProperties"))):null,Object(b.jsx)(m.j,v({},e.getSectionProps("formSupplementaryDocs"))),Object(b.jsx)(m.l,v({},e.getSectionProps("formUsageProviders"))),Object(b.jsx)(m.i,v({},e.getSectionProps("formRelatedAgreements")))]})]})})})})}})})})}}])&&P(t.prototype,r),n&&P(t,n),i}(o.a.Component);x.propTypes={data:i.a.shape({agreementLines:i.a.arrayOf(i.a.object).isRequired,agreementLinesToAdd:i.a.arrayOf(i.a.object).isRequired,supplementaryProperties:i.a.arrayOf(i.a.object).isRequired}).isRequired,form:i.a.shape({change:i.a.func.isRequired,getRegisteredFields:i.a.func.isRequired,getState:i.a.func.isRequired}).isRequired,handlers:i.a.PropTypes.shape({onBasketLinesAdded:i.a.func.isRequired,onClose:i.a.func.isRequired}),initialValues:i.a.object,handleSubmit:i.a.func.isRequired,isLoading:i.a.bool,onSubmit:i.a.func.isRequired,invalid:i.a.bool,pristine:i.a.bool,submitting:i.a.bool,values:i.a.object},x.defaultProps={initialValues:{}},t.a=Object(p.a)({initialValuesEqual:function(e,t){return Object(s.isEqual)(e,t)},keepDirtyOnReinitialize:!0,subscription:{values:!0},mutators:{setFieldData:c.a},navigationCheck:!0})(x)}}]);