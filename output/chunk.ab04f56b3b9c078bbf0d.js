(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{2760:function(e,t,r){"use strict";r.r(t);var n=r(3),a=r.n(n),i=r(1),s=r.n(i),o=r(7),c=r(9),l=r(1392),u=r(29),d=r(150),p=r(2),f=r(2949),b=r(2939),j=r(2950),h=r(0);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,i=[],s=!0,o=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);s=!0);}catch(e){o=!0,a=e}finally{try{s||null==r.return||r.return()}finally{if(o)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var x={activeFilters:s.a.object,data:s.a.object.isRequired,filterHandlers:s.a.object},S=["publicationType","type","tags"];function w(e){var t=e.activeFilters,r=e.data,a=e.filterHandlers,i=v(Object(n.useState)({publicationType:[],type:[],tags:[],isPackage:[{value:"package",label:Object(h.jsx)(u.a,{id:"ui-agreements.yes"})},{value:"nopackage",label:Object(h.jsx)(u.a,{id:"ui-agreements.no"})}]}),2),s=i[0],o=i[1];Object(n.useEffect)((function(){var e,t,n,a={};S.forEach((function(e){var t,n=r["".concat(e,"Values")];n.length!==(null===(t=s[e])||void 0===t?void 0:t.length)&&(a[e]=n)})),(null!==(e=null==r||null===(t=r.tagsValues)||void 0===t?void 0:t.length)&&void 0!==e?e:0)!==(null===(n=s.tags)||void 0===n?void 0:n.length)&&(a.tags=r.tagsValues.map((function(e){var t=e.label;return{value:t,label:t}}))),Object.keys(a).length&&o((function(e){return y(y({},e),a)}))}),[r,s]);var l,d,f,b=function(e,r){var n="isPackage"===e?"class":e,i=t[n]||[];return Object(h.jsx)(p.a,y(y({displayClearButton:i.length>0,header:p.x,id:"filter-accordion-".concat(e),label:Object(h.jsx)(u.a,{id:"ui-agreements.eresources.".concat(e)}),onClearFilter:function(){a.clearGroup(n)},separator:!1},r),{},{children:Object(h.jsx)(c.e,{dataOptions:s[e]||[],name:n,onChange:function(e){a.state(y(y({},t),{},g({},e.name,e.values)))},selectedValues:i})}))};return Object(h.jsxs)(p.b,{children:[b("type"),b("publicationType"),b("isPackage"),(d=r.sourceValues.map((function(e){return{label:e.name,value:e.id}})),f=t.remoteKb||[],Object(h.jsx)(p.a,{displayClearButton:f.length>0,header:p.x,id:"filter-accordion-remoteKb",label:Object(h.jsx)(u.a,{id:"ui-agreements.eresources.sourceKb"}),onClearFilter:function(){a.clearGroup("remoteKb")},separator:!1,children:Object(h.jsx)(p.wb,{dataOptions:d,id:"remoteKb-filter",onChange:function(e){return a.state(y(y({},t),{},{remoteKb:[e]}))},value:f[0]||""})})),(l=t.tags||[],Object(h.jsx)(p.a,{closedByDefault:!0,displayClearButton:l.length>0,header:p.x,id:"clickable-tags-filter",label:Object(h.jsx)(u.a,{id:"ui-agreements.agreements.tags"}),onClearFilter:function(){a.clearGroup("tags")},separator:!1,children:Object(h.jsx)(c.t,{dataOptions:s.tags||[],id:"tags-filter",name:"tags",onChange:function(e){return a.state(y(y({},t),{},{tags:e.values}))},selectedValues:l})}))]})}w.propTypes=x,w.defaultProps={activeFilters:{}};var C=r(993),T=r(415),q=r(416),k=r(858),P=r.n(k);function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,i=[],s=!0,o=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);s=!0);}catch(e){o=!0,a=e}finally{try{s||null==r.return||r.return()}finally{if(o)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return V(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var E={children:s.a.object,data:s.a.shape({eresources:s.a.arrayOf(s.a.object).isRequired}),onNeedMoreData:s.a.func.isRequired,queryGetter:s.a.func.isRequired,querySetter:s.a.func.isRequired,searchString:s.a.string,selectedRecordId:s.a.string,source:s.a.shape({loaded:s.a.func,totalCount:s.a.func})},N=function(e){var t,r,a,i=e.children,s=e.data,l=void 0===s?{}:s,m=e.onNeedMoreData,y=e.queryGetter,g=e.querySetter,v=e.searchString,O=e.selectedRecordId,x=e.source,S=null!==(t=null==x?void 0:x.totalCount())&&void 0!==t?t:0,k=null!==(r=y())&&void 0!==r?r:{},V=null!==(a=k.sort)&&void 0!==a?a:"",E=Object(n.useRef)(null),N=R(Object(d.useLocalStorage)("@folio/agreements/eresourcesFilterPaneVisibility",!0),1)[0],A=R(Object(n.useState)(N),2),D=A[0],F=A[1],I=function(){F(!D),Object(d.writeStorage)("@folio/agreements/eresourcesFilterPaneVisibility",!D)};return Object(h.jsx)("div",{children:Object(h.jsx)(c.D,{initialFilterState:{},initialSearchState:{query:""},initialSortState:{sort:"name"},queryGetter:y,querySetter:g,sortableColumns:["name","publicationType"],children:function(e){var t,r=e.searchValue,n=e.getSearchHandlers,a=e.onSubmitSearch,s=e.onSort,d=e.getFilterHandlers,y=e.activeFilters,g=e.filterChanged,R=e.searchChanged,N=e.resetAll,A=y.string?y.string.split(",").length:0;return Object(h.jsxs)(c.z,{appId:"@folio/agreements",id:"eresources-paneset",children:[D&&Object(h.jsx)(p.db,{defaultWidth:"20%",id:"pane-eresources-search",lastMenu:Object(h.jsx)(p.jb,{children:Object(h.jsx)(c.g,{onClick:I})}),paneTitle:Object(h.jsx)(u.a,{id:"stripes-smart-components.searchAndFilter"}),children:Object(h.jsxs)("form",{onSubmit:a,children:[Object(h.jsx)(C.default,{children:Object(h.jsxs)(p.g,{fullWidth:!0,children:[Object(h.jsx)(p.f,{id:"clickable-nav-agreements",to:T.h.agreements(),children:Object(h.jsx)(u.a,{id:"ui-agreements.agreements"})}),Object(h.jsx)(p.f,{buttonStyle:"primary",id:"clickable-nav-eresources",children:Object(h.jsx)(u.a,{id:"ui-agreements.eresources"})}),Object(h.jsx)(o.f,{perm:"ui-agreements.platforms.view",children:Object(h.jsx)(p.f,{id:"clickable-nav-platforms",to:T.h.platforms(),children:Object(h.jsx)(u.a,{id:"ui-agreements.platforms"})})})]})}),Object(h.jsxs)("div",{className:P.a.searchGroupWrap,children:[Object(h.jsx)(u.a,{id:"ui-agreements.agreements.searchInputLabel",children:function(e){return Object(h.jsx)(p.ub,{"aria-label":e,autoFocus:!0,className:P.a.searchField,id:"input-eresource-search",inputRef:E,marginBottom0:!0,name:"query",onChange:n().query,onClear:n().reset,value:r.query})}}),Object(h.jsx)(p.f,{buttonStyle:"primary",disabled:!r.query||""===r.query,fullWidth:!0,id:"clickable-search-eresources",marginBottom0:!0,type:"submit",children:Object(h.jsx)(u.a,{id:"stripes-smart-components.search"})})]}),Object(h.jsx)("div",{className:P.a.resetButtonWrap,children:Object(h.jsx)(p.f,{buttonStyle:"none",disabled:!g&&!R,id:"clickable-reset-all",onClick:N,children:Object(h.jsx)(p.G,{icon:"times-circle-solid",children:Object(h.jsx)(u.a,{id:"stripes-smart-components.resetAll"})})})}),Object(h.jsx)(w,{activeFilters:y.state,data:l,filterHandlers:d()})]})}),Object(h.jsx)(p.db,{appIcon:Object(h.jsx)(o.b,{app:"agreements",iconKey:"eresource",size:"small"}),defaultWidth:"fill",firstMenu:D?null:Object(h.jsx)(p.jb,{children:Object(h.jsx)(c.q,{filterCount:A,onClick:I})}),id:"pane-eresources-list",noOverflow:!0,padContent:!1,paneSub:null!=x&&x.loaded()?Object(h.jsx)(u.a,{id:"stripes-smart-components.searchResultsCountHeader",values:{count:x.totalCount()}}):Object(h.jsx)(u.a,{id:"stripes-smart-components.searchCriteria"}),paneTitle:Object(h.jsx)(u.a,{id:"ui-agreements.eresources"}),children:Object(h.jsx)(p.W,{autosize:!0,columnMapping:{name:Object(h.jsx)(u.a,{id:"ui-agreements.eresources.name"}),publicationType:Object(h.jsx)(u.a,{id:"ui-agreements.eresources.publicationType"}),isbn:Object(h.jsx)(u.a,{id:"ui-agreements.identifier.isbn"}),eissn:Object(h.jsx)(u.a,{id:"ui-agreements.identifier.eissn"}),pissn:Object(h.jsx)(u.a,{id:"ui-agreements.identifier.pissn"})},columnWidths:{name:300,publicationType:100,isbn:150,eissn:150,pissn:150},contentData:l.eresources,formatter:{name:function(e){var t,r;return Object(h.jsx)(o.b,{app:"agreements",iconAlignment:"baseline",iconKey:"eresource",size:"small",children:null!==(t=null===(r=e._object)||void 0===r?void 0:r.longName)&&void 0!==t?t:e.name})},publicationType:function(e){return Object(h.jsx)(f.a,{resource:e})},isbn:function(e){return Object(b.a)(e._object,"isbn")},eissn:function(e){return Object(b.a)(e._object,"eissn")},pissn:function(e){var t;return null!==(t=Object(b.a)(e._object,"pissn"))&&void 0!==t?t:Object(j.a)(e._object,"issn")}},id:"list-eresources",isEmptyMessage:x?Object(h.jsx)("div",{children:Object(h.jsx)(c.C,{filterPaneIsVisible:!0,searchTerm:null!==(t=k.query)&&void 0!==t?t:"",source:x,toggleFilterPane:I})}):"...",isSelected:function(e){return e.item.id===O},onHeaderClick:s,onNeedMoreData:m,pageAmount:q.h.RESULT_COUNT_INCREMENT,pagingType:"click",rowProps:{labelStrings:function(e){return[e.rowData.name]},to:function(e){return"".concat(T.h.eresourceView(e)).concat(v)}},sortDirection:V.startsWith("-")?"descending":"ascending",sortOrder:V.replace(/^-/,"").replace(/,.*/,""),totalCount:S,virtualize:!0,visibleColumns:["name","publicationType","isbn","eissn","pissn"]})}),i]})}})})};N.propTypes=E;var A=N,D=r(2973);function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=K(e);if(t){var a=K(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return G(this,r)}}function G(e,t){if(t&&("object"===F(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var B=q.h.RESULT_COUNT_INCREMENT,U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(s,e);var t,r,n,i=M(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e)).handleNeedMoreData=function(e,r){t.source&&r>0?t.source.fetchOffset(r):t.source.fetchMore(B)},t.querySetter=function(e){var r=e.nsValues;t.props.mutator.query.update(r)},t.queryGetter=function(){var e,r;return null!==(e=null===(r=t.props.resources)||void 0===r?void 0:r.query)&&void 0!==e?e:{}},t.logger=e.stripes.logger,t.searchField=a.a.createRef(),t.state={hasPerms:e.stripes.hasPerm("ui-agreements.agreements.view")},t}return t=s,(r=[{key:"componentDidMount",value:function(){this.source=new c.G(this.props,this.logger,"eresources"),this.searchField.current&&this.searchField.current.focus()}},{key:"componentDidUpdate",value:function(e){var t=this.source.totalCount(),r=this.source.records();if(1===t){var n=this.props,a=n.history,i=n.location,s=new c.G(e,this.logger,"eresources"),o=s.totalCount(),l=s.records();if(1!==o||1===o&&l[0].id!==r[0].id){var u=r[0];a.push("".concat(T.h.eresourceView(u.id)).concat(i.search))}}}},{key:"render",value:function(){var e,t,r,n,a,i,s,o,c,l,u=this.props,d=u.children,p=u.location,f=u.match,b=u.resources;return this.source&&this.source.update(this.props,"eresources"),this.state.hasPerms?Object(h.jsx)(A,{data:{eresources:null!==(e=null==b||null===(t=b.eresources)||void 0===t?void 0:t.records)&&void 0!==e?e:[],publicationTypeValues:null!==(r=null==b||null===(n=b.publicationTypeValues)||void 0===n?void 0:n.records)&&void 0!==r?r:[],sourceValues:null!==(a=null==b||null===(i=b.sourceValues)||void 0===i?void 0:i.records)&&void 0!==a?a:[],typeValues:null!==(s=null==b||null===(o=b.typeValues)||void 0===o?void 0:o.records)&&void 0!==s?s:[],tagsValues:null!==(c=null==b||null===(l=b.tagsValues)||void 0===l?void 0:l.records)&&void 0!==c?c:[]},onNeedMoreData:this.handleNeedMoreData,queryGetter:this.queryGetter,querySetter:this.querySetter,searchString:p.search,selectedRecordId:f.params.id,source:this.source,children:d}):Object(h.jsx)(D.a,{})}}])&&I(t.prototype,r),n&&I(t,n),s}(a.a.Component);U.manifest=Object.freeze({eresources:{type:"okapi",path:"erm/resource/electronic",records:"results",resultOffset:"%{resultOffset}",perRequest:q.h.RESULT_COUNT_INCREMENT,limitParam:"perPage",params:Object(l.a)({searchKey:"name,identifiers.identifier.value",filterConfig:[{name:"class",values:[{name:"package",value:"org.olf.kb.Pkg"},{name:"nopackage",value:"org.olf.kb.TitleInstance"}]}],filterKeys:{remoteKb:"remoteKb.id",tags:"tags.value",publicationType:"publicationType.value",type:"type.value"}})},publicationTypeValues:{type:"okapi",path:"erm/refdata/TitleInstance/publicationType",perRequest:100,limitParam:"perPage"},sourceValues:{type:"okapi",path:"erm/kbs",shouldRefresh:function(){return!1}},typeValues:{type:"okapi",path:"erm/refdata/TitleInstance/type",perRequest:100,limitParam:"perPage"},tagsValues:{type:"okapi",path:"tags",params:{limit:"1000",query:"cql.allRecords=1 sortby label"},records:"tags"},query:{initialValue:{}},resultOffset:{initialValue:0}}),U.propTypes={children:s.a.node,history:s.a.shape({push:s.a.func.isRequired}).isRequired,location:s.a.shape({pathname:s.a.string,search:s.a.string}).isRequired,match:s.a.shape({params:s.a.shape({id:s.a.string})}),mutator:s.a.object,resources:s.a.object,stripes:s.a.shape({hasPerm:s.a.func.isRequired,logger:s.a.object})};t.default=Object(o.o)(U)},2973:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));r(3);var n=r(29),a=r(2),i=r(0),s=function(){return Object(i.jsxs)(a.M,{className:"textCentered",children:[Object(i.jsx)("h2",{children:Object(i.jsx)(n.a,{id:"stripes-smart-components.permissionError"})}),Object(i.jsx)("p",{children:Object(i.jsx)(n.a,{id:"stripes-smart-components.permissionsDoNotAllowAccess"})})]})}}}]);